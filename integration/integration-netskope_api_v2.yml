category: Network Security
commonfields:
  id: netskope_api_v2
  version: -1
configuration:
- defaultvalue: https://{environment}.goskope.com
  display: Server URL
  name: url
  required: true
  type: 0
- defaultvalue: "false"
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- defaultvalue: "false"
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- additionalinfo: Netskope API access token (make sure to generate token for the required
    endpoints).
  display: ""
  displaypassword: API token
  hiddenusername: true
  name: credentials
  required: true
  type: 9
- additionalinfo: First alert created date to fetch. e.g., "1 min ago","2 weeks ago","3
    months ago".
  defaultvalue: 3 days
  display: First fetch timestamp
  name: first_fetch
  required: false
  type: 0
- additionalinfo: Maximum number of incidents per fetch. Default is 50. The maximum
    is 100.
  defaultvalue: "50"
  display: Maximum incidents per fetch
  name: max_fetch
  required: false
  type: 0
- defaultvalue: "50"
  display: Maximum events as incidents per fetch. Max value is 200.
  name: max_events_fetch
  required: false
  type: 0
- additionalinfo: Fetch events as incidents, in addition to the alerts.
  display: Fetch Events
  name: fetch_events
  required: false
  type: 8
- additionalinfo: The event types to fetch as incidents.
  display: Event types to fetch.
  name: event_types
  options:
  - page
  - application
  - audit
  - infrastructure
  - network
  required: false
  type: 16
- additionalinfo: Free text query to filter the fetched alerts. For more information,
    visit Netskope documentation (https://docs.netskope.com/en/get-alerts-data.html).
  display: Alerts Query
  name: alerts_query
  required: false
  type: 0
- additionalinfo: Free text query to filter the fetched events (if configured). For
    more information, visit Netskope documentation (https://docs.netskope.com/en/get-alerts-data.html).
  display: Events Query
  name: events_query
  required: false
  type: 0
- display: Incident type
  name: incidentType
  required: false
  type: 13
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- defaultvalue: "1"
  display: Incidents Fetch Interval
  name: incidentFetchInterval
  required: false
  type: 19
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.9.0
    itemVersion: 3.3.1
    packID: Netskope
    packName: Netskope
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: Netskope API v2 provides a powerful interface for managing and monitoring
  Netskope deployments. It enables users to retrieve alerts and events, manage URL
  lists, and control clients. With Netskope API v2, organizations can proactively
  respond to security threats, enforce web access policies, and efficiently administer
  their Netskope environment.
detaileddescription: |-
  Follow these instructions to successfully instantiate an instance of the Netskope API v2 integration.
  Enter an API token and your Server URL.

  #### Follow these instructions to retrieve the API token:
  1. Log in to your Netskope account as an administrator.
  2. Click **Settings** in the left sidebar menu.
  3. On the newly opened window, in the left sidebar, click **Tools** >> **REST API v2**.
  4. On the REST API v2 page, click **NEW TOKEN**.
  5. Click **ADD ENDPOINT** to add the following endpoints to your API token:
      - api/v2/events/data/application
      - api/v2/events/data/audit
      - api/v2/events/data/page
      - api/v2/events/data/network
      - api/v2/events/data/infrastructure
      - api/v2/events/data/alert
      - api/v2/policy/urllist (read + write permissions)
      - api/v2/policy/urllist/deploy (read + write permissions)
      - api/v2/scim/Users
  6. Make sure to fill in the **EXPIRE IN** and **TOKEN NAME** fields and click **SAVE**.
  7. A new API token will be generated for you. Copy the generated API token and keep it secure.

  Note that the API token is generated with permissions to the specified endpoints.

  #### Find your Server URL:
  The server URL consists of the Netskope account name and region.
  For example, if your company account name in Netskope is `xsoar`, and your account provided region is `de`, then the Server URL configuration parameter would be `https://xsoar.de.goskope.com`.


  ---
  [View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/netskope-api-v2)
display: Netskope (API v2)
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAMAAACgee/qAAABs1BMVEUAAABXV1wKDhNVVVpVVVVVVVlWVlZVVVpVVVpTU1tUVFhUVFdXV1dVVVlUVFlOTlZTU1dLS1BWVltUVVpVVVlUVFdTU1dVVVlUVFlTU1hUVFZTU1VLS1IAqdNVVVpVVVpVVVpLS0tVVVpUVFVPT08uLkRVVVlUVFpTU1hVVVpVVVlSUldVVVtQUFJTU1lUVFdVVVlUVFlUU1hUVFhSUllSUlRUVFpUVFpUVFlUVFlUVFlUU1hUVFlUVFpTU1dVVVpUVFdRUVV1V1lUVFhVVVhUVFf4gABUVFr3cwAAqNH1fwBRUlpQUFZISFFGRlgAqdIAqNJVVVVLS1kApM1GRlgApdQAqdH1fgD1fgAAqNEAp9EAqNIAqdP1fAAAp9AAp88AospOTlnzeQBDQ14AocoAp9H7gQAAqNL4fgBcS0v0fQAAqNIAp9AAp8/0fQD1fgAAps9BZnH1fwAApc4ApMu/bSEAp88ApcoAver3gAD4gQBOU11NVF4Ap9D0fwD1fwDyfgD0fQD0fgD0egBKSltWVltZWV5YWF1bW2D2gAAAq9UArtj6ggD9gwD4gAAAsdxdXWIL5SRVAAAAhXRSTlMA/gLbHOQL/fo3jokX6LkgcQj47tdgQs/HbUoRDv304MsGwikUCfCPhOu9PC0jk0W0p3pkWyf259OimlSwq3VZUTUFfWlN+Z8V7X5HMhkW5towKyYdEfTk2M6mhoBtaV9VLiITBsa0l46NjXx3b1xVSkpHQjs5MhgL7NDOybmpnWFgXy4teju0XQAABgJJREFUWMPclMlr20AUxt+4i5NAaBwjt6kZpyFQN6EE4ranGJemVEgqrQ1uvG+Y7Pue7tlQJpqR5H85EpYUE3zJ4V3yuwz8Lh/fzLwHD5DJsTcjn+64fKO2eRgCTOZTU+yKJZJPe2UjKzqdwsoCIDJCiK7rhCV7+jWpKJSzQlQWAY1nT5juQhK3t32S6+QOFvIVTluAxpzuwTKBO6C06b5zlv8DNN4xP3gocC1eOHaOxSWRAzS+hv3gdOA2BN9yjmOVVwAL5eiPV5kMf/DczyXB1UZ+tyzUQ0AitL78Meols9lIV25SSjlXqeA1QKK9Kturc38HCHPDyeyk27dKHbgQNLeFMk2X9fX/RdMwzOWjmJSaDhOn83A6mdmrqZzycrW5ewIIzGu/TMuyDcOWNQUAIlKUuGvkir1ea2VpFW1naaZT1sXUPCONep+MrW2sABbtop9bUjwVmfYnOrGHt6O3baOLdRq4z8Sf6BSgUbf8YC1wUhA8A2js+I3ts8DFBm63NhpKqVvZLLYDF3/FurlTbwGPbdlNtuR6j3sZZW5uOAOY7PyWbbl0HoLe5BejJPxobAJQUfYv9pU7Lh6TvnyDe/M93ldP/ECu8Ph5OtLPvx+XAJVBfbzvNQ1dzwAqgzfdlttu2kAQhtcnTBKMwTbEBoQdc8bhDOUUCoFEXKSNlCovUOVV6tm97CN37bVdWiH1oqpadW5YZtfz7c7+M3ZayJzzX5HWj47/Cfx8Hnz5m5GZ3ie73omg1tbEayTgXqVciSYeJ9uLyk/g3gUr24o3sba3bMwmdtbD00m6GnTBWkWJ8VNHBsDzVh2xAAcbA6S7xQicFgzBCCS8twQO4J1plU/B94vqhyDK1qRRQB+9IGavfQkDcEYuFTm8bJpipHYlBj9oYG9G9LFh6CpvQO72lzbo6xCscdVqtTkOFvq+ORpKQA4n4KJNHJGW9RUHwmiVrRKpFPpnDsjuarnAeMMOtO6Avex3ZdhE5JoES3r+VKGJrWDnlyCtaW9QRyDNArBse7UvNZr4uuGPG4h/tdz1d/DjHNzgknJYO2Qo33NB+hykrUvsXZ4+9L4Kqz11vCgh5matQJuB+3jBttQGk668r2o7dvEmabE7rkc7rOoia1ooARd0uMsEcwoXvQQ+OmREF0y5ZpE5cuk0zQG/JEOW8wlWauFAgstYRopK8WR4E7/CjfJpOb1KXIsNYzBvaXgVJm4MTnyVO03/hPgROcaSMsmSR72ONoj+X2N25HdcjnnUefMW3WQhh2alwWBQnGjVz6dgvo1B6O/E7+CcprXz4dQdaSclIuApajh4GzsOsCijkiyUU8VBEDeLjR/BokLBKQfvUteYo+Zj2TsFo/x7ARPO7s/iBjIk0ic2Y0LSufddkkOphf8UO7ZYUlEBXPTAceyD890ZcMOE6f6qmw1tVU/A0ZLp0eCIcB+d+GUB17Xw1l14CH7ZmFgode2XYkcBJBFNwbzxhllm1hkwvyFXNHVh/s62zOepAXf7SFwfDELJoXSOyeYkrkTBkIsdLUJF68lKD/FxdzkDRhYYMajBh+X0c68ucfZHBg7JTi84FVY+RdMWFjIB2E1FYYWgfsoGWHHDyp8F03UrNvPovA9Ca0rU5YqtF+b3jXIETshvDmQzbNUcxoiCsd/mw90fQaqFupe8cMHbyu2dA6Ophu8GmeeLy2oYum5Af6YW6W0fv3ZaRVXcGeSST8DoXiAmDTTQwdmqb7fjDhlWQjCWj1498zTEWiEUu0uk3KyuTs1YkTKOy6lDy4fapENkSdJIul8JOyoHTT0ovduhT2Rd94krBuL62kcxecPTPAiAO3YVuM1HFIDljU7S0twnyoRn4bMATVvHZBF1lqEd6a/SNZ9ZqJXR6QijEs9UWnDnUvjGyJdW1/O5cwhz+uQ+xi9Od8wHgduOott32zxi4IG3FPTOopV8TlceunNdMQ9iLCE11lo9UVF5NqvHXgoUxXw0TIliKvYilIgwmlRrGTaMyqk+6wVJOwlUUxvojxoD/9r+H3Bl8ZfAja52gf6K1Yp79E/aN/cOdSx4Lr2hAAAAAElFTkSuQmCC
name: netskope_api_v2
script:
  commands:
  - arguments:
    - description: 'Restrict events to those that have dates greater than the provided
        date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2 weeks ago").
        Note that if this argument is provided, you must also provide the ‘end_time’
        argument. '
      name: start_time
    - description: Restrict events to those that have dates less than or equal to
        the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2
        weeks ago").  Note that if this argument is provided, you must also provide
        the ‘start_time’ argument. If start_time argument is provided and this argument
        is not - the default value will be set for now.
      name: end_time
    - description: 'Restrict events to those that were inserted to the system after
        the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2
        weeks ago").  Note that if this argument is provided, you must also provide
        the ‘insertion_end_time’ argument. '
      name: insertion_start_time
    - description: Restrict events to those that were inserted to the system before
        the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2
        weeks ago"). Note that if this argument is provided, you must also provide
        the ‘insertion_start_time’ argument. If insertion_start_time argument is provided
        and this argument is not - the default value will be set for now.
      name: insertion_end_time
    - description: 'Free query by which to filter the alerts. For example, "alert_name
        like test". For more information, visit Netskope documentation: https://docs.netskope.com/en/get-alerts-data.html.'
      name: query
    - auto: PREDEFINED
      description: Select alerts by their type.
      name: alert_type
      predefined:
      - anomaly
      - Compromised Credential
      - policy
      - Legal Hold
      - malsite
      - Malware
      - DLP
      - Security Assessment
      - watchlist
      - quarantine
      - Remediation
      - uba
    - auto: PREDEFINED
      description: Whether to retrieve acknowledged alerts or not.
      name: retrieve_acknowledged
      predefined:
      - "True"
      - "False"
    - description: 'Page number of paginated results. Minimum value: 1.'
      name: page
    - defaultValue: "50"
      description: The maximum number of records to retrieve.
      name: limit
    description: Get alerts generated by Netskope. You may choose what alerts to receive
      with the alert_type parameter. You must provide start_time and end_time, or
      insertion_start_time and insertion_end_time. (Note that if end_time or insertion_end_time
      aren't provided. the date time would be set as now.) You cannot provide a combination
      of the options mentioned above.
    name: netskope-alert-list
    outputs:
    - contextPath: Netskope.Alert._appsession_start
      description: The timestamp marking the start of an application session.
      type: String
    - contextPath: Netskope.Alert._category_id
      description: The unique identifier for a category.
      type: String
    - contextPath: Netskope.Alert._category_name
      description: The name or label associated with a category.
      type: String
    - contextPath: Netskope.Alert._category_tags
      description: Numeric tags or labels associated with the category.
      type: Number
    - contextPath: Netskope.Alert._content_version
      description: A numeric value representing the content version.
      type: Number
    - contextPath: Netskope.Alert._correlation_id
      description: An identifier used for correlating events or data.
      type: String
    - contextPath: Netskope.Alert._creation_timestamp
      description: The timestamp when the data or event was created.
      type: Number
    - contextPath: Netskope.Alert._ef_received_at
      description: The timestamp indicating when the event was received.
      type: Date
    - contextPath: Netskope.Alert._event_id
      description: A unique identifier for the event.
      type: String
    - contextPath: Netskope.Alert._forwarded_by
      description: Information indicating the source responsible for forwarding the
        event.
      type: String
    - contextPath: Netskope.Alert._gef_src_dp
      description: The source data path for the event.
      type: String
    - contextPath: Netskope.Alert._id
      description: A unique identifier for the event or data.
      type: String
    - contextPath: Netskope.Alert._insertion_epoch_timestamp
      description: Insertion timestamp.
      type: Number
    - contextPath: Netskope.Alert._nshostname
      description: The hostname associated with Netskope.
      type: String
    - contextPath: Netskope.Alert._raw_event_inserted_at
      description: The timestamp indicating when the raw event was inserted.
      type: Date
    - contextPath: Netskope.Alert._service_identifier
      description: An identifier associated with a specific service.
      type: String
    - contextPath: Netskope.Alert._session_begin
      description: The timestamp marking the beginning of a session.
      type: String
    - contextPath: Netskope.Alert._skip_geoip_lookup
      description: A flag indicating whether GeoIP lookup should be skipped.
      type: String
    - contextPath: Netskope.Alert._src_epoch_now
      description: A numeric value representing the source epoch.
      type: Number
    - contextPath: Netskope.Alert.access_method
      description: Cloud app traffic can be steered to the Netskope cloud using different
        deployment methods such as Client (Netskope Client), Secure Forwarder etc.
        Administrators can also upload firewall and/or proxy logs for log analytics.
        This field shows the actual access method that triggered the event. For log
        uploads this shows the actual log type such as PAN, Websense, etc.
      type: String
    - contextPath: Netskope.Alert.acked
      description: Whether the user acknowledged the alert or not.
      type: String
    - contextPath: Netskope.Alert.action
      description: Action taken on the event for the policy.
      type: String
    - contextPath: Netskope.Alert.activity
      description: Description of the user-performed activity.
      type: String
    - contextPath: Netskope.Alert.alert
      description: Indicates whether the alert is generated or not. Populated as yes
        for all alerts.
      type: String
    - contextPath: Netskope.Alert.alert_name
      description: Name of the alert.
      type: String
    - contextPath: Netskope.Alert.alert_type
      description: Type of the alert.
      type: String
    - contextPath: Netskope.Alert.app
      description: Specific cloud application used by the user (e.g., app = Dropbox).
      type: String
    - contextPath: Netskope.Alert.app_session_id
      description: Unique App/Site Session ID for traffic_type = CloudApp and Web.
        An app session starts when a user starts using a cloud app/site and ends once
        they have been inactive for a certain period of time (15 mins). Use app_session_id
        to check all the user activities in a single app session. app_session_id is
        unique for a user, device, browser, and domain.
      type: Number
    - contextPath: Netskope.Alert.appcategory
      description: Application category as designated by Netskope.
      type: String
    - contextPath: Netskope.Alert.appsuite
      description: Information related to the suite of applications or software used.
      type: String
    - contextPath: Netskope.Alert.browser
      description: Shows the actual browser from where the cloud app was accessed.
      type: String
    - contextPath: Netskope.Alert.browser_session_id
      description: Browser session ID. If there is an idle timeout of 15 minutes,
        it will time out the session.
      type: Number
    - contextPath: Netskope.Alert.category
      description: A classification or grouping label for data or events.
      type: String
    - contextPath: Netskope.Alert.cci
      description: Cloud Confidence Index, indicating the readiness and security of
        cloud applications.
      type: Number
    - contextPath: Netskope.Alert.ccl
      description: 'Cloud Confidence Level. CCL measures the enterprise readiness
        of the cloud apps taking into consideration those apps'' security, auditability,
        and business continuity. Each app is assigned one of five cloud confidence
        levels: excellent, high, medium, low, or poor. Useful for querying if users
        are accessing a cloud app with a lower CCL.'
      type: String
    - contextPath: Netskope.Alert.connection_id
      description: Each connection has a unique ID. Shows the ID for the connection
        event.
      type: Number
    - contextPath: Netskope.Alert.count
      description: Number of raw log lines/events sessionized or suppressed during
        the suppressed interval.
      type: Number
    - contextPath: Netskope.Alert.device
      description: Device type from where the user accessed the cloud app. It could
        be Macintosh Windows device, iPad, etc.
      type: String
    - contextPath: Netskope.Alert.device_classification
      description: Designation of the device as determined by the Netskope Client
        as to whether the device is managed or not.
      type: String
    - contextPath: Netskope.Alert.domain
      description: Domain value. This will hold the host header value or SNI or extracted
        from an absolute URI.
      type: String
    - contextPath: Netskope.Alert.dst_country
      description: Application’s two-letter country code as determined by Maxmind
        or IP2Location Geodatabase.
      type: String
    - contextPath: Netskope.Alert.dst_latitude
      description: Latitude of the application as determined by Maxmind or IP2Location
        Geodatabase.
      type: Number
    - contextPath: Netskope.Alert.dst_location
      description: Application’s city as determined by maxmind or IP2Location Geodatabase.
      type: String
    - contextPath: Netskope.Alert.dst_longitude
      description: Longitude of the application as determined by Maxmind or IP2Location
        Geodatabase.
      type: Number
    - contextPath: Netskope.Alert.dst_region
      description: Application’s state or region as determined by Maxmind or IP2Location
        Geodatabase.
      type: String
    - contextPath: Netskope.Alert.dst_timezone
      description: Destination timezone.
      type: String
    - contextPath: Netskope.Alert.dst_zipcode
      description: Application’s zip code as determined by Maxmind or IP2Location
        Geodatabase.
      type: String
    - contextPath: Netskope.Alert.dstip
      description: IP address where the destination app is hosted.
      type: String
    - contextPath: Netskope.Alert.hostname
      description: Host name.
      type: String
    - contextPath: Netskope.Alert.incident_id
      description: A unique identifier for an incident or event.
      type: Number
    - contextPath: Netskope.Alert.ja3
      description: A field indicating JA3 information.
      type: String
    - contextPath: Netskope.Alert.ja3s
      description: A field indicating JA3S information.
      type: String
    - contextPath: Netskope.Alert.managed_app
      description: Whether or not the app in question is managed.
      type: String
    - contextPath: Netskope.Alert.managementID
      description: Management ID.
      type: String
    - contextPath: Netskope.Alert.netskope_pop
      description: Netskope Point of Presence, related to network infrastructure.
      type: String
    - contextPath: Netskope.Alert.notify_template
      description: The template used for notifications or alerts.
      type: String
    - contextPath: Netskope.Alert.nsdeviceuid
      description: Device identifiers on macOS and Windows.
      type: String
    - contextPath: Netskope.Alert.organization_unit
      description: Organization units for which the event correlates to. This ties
        to user information extracted from Active Directory using the Directory Importer/AD
        Connector application.
      type: String
    - contextPath: Netskope.Alert.os
      description: Operating system of the host that generated the event.
      type: String
    - contextPath: Netskope.Alert.os_version
      description: Operating system version of the host.
      type: String
    - contextPath: Netskope.Alert.other_categories
      description: Additional categories or labels not specified elsewhere.
      type: String
    - contextPath: Netskope.Alert.page
      description: The URL of the originating page.
      type: String
    - contextPath: Netskope.Alert.page_site
      description: Information about the web page or site being accessed.
      type: String
    - contextPath: Netskope.Alert.policy
      description: Name of the policy configured by an admin.
      type: String
    - contextPath: Netskope.Alert.policy_id
      description: The Netskope internal ID for the policy created by an admin.
      type: String
    - contextPath: Netskope.Alert.port
      description: The network port used for communication.
      type: String
    - contextPath: Netskope.Alert.protocol
      description: The communication protocol or method used.
      type: String
    - contextPath: Netskope.Alert.request_id
      description: Unique request ID for the event.
      type: Number
    - contextPath: Netskope.Alert.severity
      description: Severity used by watchlist and malware alerts.
      type: String
    - contextPath: Netskope.Alert.site
      description: For traffic_type = CloudApp, site = app, and for traffic_type =
        Web, it will be the second-level domain name + top-level domain name. For
        example, in “www.cnn.com”, it is “cnn.com”.
      type: String
    - contextPath: Netskope.Alert.src_country
      description: User’s country’s two-letter country code as determined by Maxmind
        or IP2Location Geodatabase.
      type: String
    - contextPath: Netskope.Alert.src_latitude
      description: Latitude of the user as determined by Maxmind or IP2Location Geodatabase.
      type: Number
    - contextPath: Netskope.Alert.src_location
      description: User’s city as determined by Maxmind or IP2Location Geodatabase.
      type: String
    - contextPath: Netskope.Alert.src_longitude
      description: Longitude of the user as determined by Maxmind or IP2Location Geodatabase.
      type: Number
    - contextPath: Netskope.Alert.src_region
      description: Source state or region as determined by Maxmind or IP2Location
        Geodatabase.
      type: String
    - contextPath: Netskope.Alert.src_time
      description: A timestamp associated with the source or event.
      type: Date
    - contextPath: Netskope.Alert.src_timezone
      description: Source timezone. Shows the long-format timezone designation.
      type: String
    - contextPath: Netskope.Alert.src_zipcode
      description: Source zip code as determined by Maxmind or IP2Location Geodatabase.
      type: String
    - contextPath: Netskope.Alert.srcip
      description: IP address of the source/user.
      type: String
    - contextPath: Netskope.Alert.telemetry_app
      description: Typically, SaaS app websites use web analytics code within the
        pages to gather analytic data. When a SaaS app action or page is shown, there
        is subsequent traffic generated to tracking apps such as doubleclick.net,
        Optimizely, etc. These tracking apps are listed if applicable in the Telemetry
        App field.
      type: String
    - contextPath: Netskope.Alert.timestamp
      description: Timestamp when the event/alert happened. Event timestamp in Unix
        epoch format.
      type: Number
    - contextPath: Netskope.Alert.traffic_type
      description: 'Type of the traffic: CloudApp or Web. CloudApp indicates CASB
        and web indicates HTTP traffic. Web traffic is only captured for inline access
        method. It is currently not captured for Risk Insights.'
      type: String
    - contextPath: Netskope.Alert.transaction_id
      description: Unique ID for a given request/response.
      type: Number
    - contextPath: Netskope.Alert.type
      description: Shows if it is an application event or a connection event. Application
        events are recorded to track user events inside a cloud app. Connection events
        show the actual HTTP connection.
      type: String
    - contextPath: Netskope.Alert.ur_normalized
      description: All lowercase user email.
      type: String
    - contextPath: Netskope.Alert.url
      description: URL of the application that the user visited as provided by the
        log or data plane traffic.
      type: String
    - contextPath: Netskope.Alert.user
      description: User email.
      type: String
    - contextPath: Netskope.Alert.useragent
      description: Browser HTTP user agent header.
      type: String
    - contextPath: Netskope.Alert.userip
      description: IP address of the user.
      type: String
    - contextPath: Netskope.Alert.userkey
      description: User ID or email.
      type: String
    - contextPath: Netskope.Alert._client_timeout
      description: Information related to client timeouts.
      type: Number
    - contextPath: Netskope.Alert._dlp_backup_profile
      description: Information related to DLP (Data Loss Prevention) backup profiles.
      type: String
    - contextPath: Netskope.Alert._nsp_dur_back
      description: Duration information for NSP (Network Security Platform) on the
        back end.
      type: Number
    - contextPath: Netskope.Alert._nsp_dur_front
      description: Duration information for NSP on the front end.
      type: Number
    - contextPath: Netskope.Alert._nsp_retrans_back
      description: Retransmission information for NSP on the back end.
      type: Number
    - contextPath: Netskope.Alert._nsp_retrans_front
      description: Retransmission information for NSP on the front end.
      type: Number
    - contextPath: Netskope.Alert._nsp_rtt_back
      description: Round-trip time information for NSP on the back end.
      type: Number
    - contextPath: Netskope.Alert._nsp_rtt_front
      description: Round-trip time information for NSP on the front end.
      type: Number
    - contextPath: Netskope.Alert._resource_name
      description: The name associated with a resource.
      type: String
    - contextPath: Netskope.Alert._scan_source
      description: Information indicating the source of a scan.
      type: String
    - contextPath: Netskope.Alert._tenant_max_file_size
      description: The maximum file size allowed for a tenant.
      type: Number
    - contextPath: Netskope.Alert.all_policy_matches
      description: Information related to policy matches.
      type: String
    - contextPath: Netskope.Alert.browser_version
      description: Browser version.
      type: String
    - contextPath: Netskope.Alert.file_size
      description: Size of the file in bytes.
      type: Number
    - contextPath: Netskope.Alert.file_type
      description: File type.
      type: String
    - contextPath: Netskope.Alert.md5
      description: MD5 of the file.
      type: String
    - contextPath: Netskope.Alert.object
      description: Name of the object which is being acted on. It could be a filename,
        folder name, report name, document name, etc.
      type: String
    - contextPath: Netskope.Alert.object_type
      description: Type of the object which is being acted on. Object type could be
        a file, folder, report, document, message, etc.
      type: String
    - contextPath: Netskope.Alert.web_universal_connector
      description: Universal web connector information.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: Select events by their type.
      name: event_type
      predefined:
      - page
      - application
      - audit
      - infrastructure
      - network
      required: true
    - description: 'Free query to filter the events. For example, "app eq Dropbox".
        For more information, visit Netskope documentation: https://docs.netskope.com/en/get-events-data.html'
      name: query
    - description: Restrict events to those that have dates greater than the provided
        date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2 weeks ago").
        Note that if this argument is provided, you must also provide the ‘end_time’
        argument.
      name: start_time
    - description: Restrict events to those that have dates less than or equal to
        the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2
        weeks ago"). Note that if this argument is provided, you must also provide
        the ‘start_time’ argument. If start_time argument is provided and this argument
        is not - the default value will be set for now.
      name: end_time
    - description: Restrict events to those that were inserted to the system after
        the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2
        weeks ago"). Note that if this argument is provided, you must also provide
        the ‘insertion_end_time’ argument.
      name: insertion_start_time
    - description: Restrict events to those that were inserted to the system before
        the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2
        weeks ago"). Note that if this argument is provided, you must also provide
        the ‘insertion_start_time’ argument. If insertion_start_time argument is provided
        and this argument is not - the default value will be set for now.
      name: insertion_end_time
    - description: 'Page number of paginated results. Minimum value: 1.'
      name: page
    - defaultValue: "50"
      description: The maximum number of records to retrieve.
      name: limit
    description: Get events extracted from SaaS traffic. You may choose what events
      to receive with the event_type parameter. You must provide start_time and end_time,
      or insertion_start_time and insertion_end_time. (Note that if end_time or insertion_end_time
      aren't provided, the date time would be set as now.) You cannot provide a combination
      of the options mentioned above.
    name: netskope-event-list
    outputs:
    - contextPath: Netskope.Event._appsession_start
      description: Netskope event application session start.
      type: String
    - contextPath: Netskope.Event._category_id
      description: Netskope event category ID.
      type: String
    - contextPath: Netskope.Event._category_name
      description: Netskope event category name.
      type: String
    - contextPath: Netskope.Event._category_tags
      description: Netskope event category tags.
      type: Number
    - contextPath: Netskope.Event._content_version
      description: Netskope event content version.
      type: Number
    - contextPath: Netskope.Event._correlation_id
      description: Netskope event correlation ID.
      type: String
    - contextPath: Netskope.Event._creation_timestamp
      description: Netskope event creation timestamp.
      type: Number
    - contextPath: Netskope.Event._ef_received_at
      description: The timestamp indicating when the event was received.
      type: Date
    - contextPath: Netskope.Event._event_id
      description: Netskope event event ID.
      type: String
    - contextPath: Netskope.Event._forwarded_by
      description: Netskope event forwarded by.
      type: String
    - contextPath: Netskope.Event._gef_src_dp
      description: The source data path for the event.
      type: String
    - contextPath: Netskope.Event._id
      description: Netskope event ID.
      type: String
    - contextPath: Netskope.Event._insertion_epoch_timestamp
      description: Netskope event insertion epoch timestamp.
      type: Number
    - contextPath: Netskope.Event._nshostname
      description: The hostname associated with Netskope.
      type: String
    - contextPath: Netskope.Event._raw_event_inserted_at
      description: The date the Netskope raw event was inserted.
      type: Date
    - contextPath: Netskope.Event._service_identifier
      description: Netskope event service identifier.
      type: String
    - contextPath: Netskope.Event._session_begin
      description: The timestamp marking the beginning of a session.
      type: String
    - contextPath: Netskope.Event._skip_geoip_lookup
      description: Netskope event skip GeoIP lookup.
      type: String
    - contextPath: Netskope.Event._src_epoch_now
      description: A numeric value representing the source epoch.
      type: Number
    - contextPath: Netskope.Event.access_method
      description: Netskope event access method.
      type: String
    - contextPath: Netskope.Event.action
      description: Netskope event action.
      type: String
    - contextPath: Netskope.Event.activity
      description: Netskope event activity.
      type: String
    - contextPath: Netskope.Event.alert
      description: Netskope event alert.
      type: String
    - contextPath: Netskope.Event.app
      description: Netskope event app.
      type: String
    - contextPath: Netskope.Event.app_session_id
      description: Netskope event app session ID.
      type: Number
    - contextPath: Netskope.Event.appcategory
      description: Netskope event app category.
      type: String
    - contextPath: Netskope.Event.appsuite
      description: Netskope event app suite.
      type: String
    - contextPath: Netskope.Event.browser
      description: Netskope event browser.
      type: String
    - contextPath: Netskope.Event.browser_session_id
      description: Netskope event browser session ID.
      type: Number
    - contextPath: Netskope.Event.category
      description: Netskope event category.
      type: String
    - contextPath: Netskope.Event.cci
      description: Netskope event Cloud Confidence Index.
      type: Number
    - contextPath: Netskope.Event.ccl
      description: Netskope event Cloud Confidence Levels.
      type: String
    - contextPath: Netskope.Event.connection_id
      description: Netskope event connection ID.
      type: Number
    - contextPath: Netskope.Event.count
      description: Netskope event count.
      type: Number
    - contextPath: Netskope.Event.device
      description: Netskope event device.
      type: String
    - contextPath: Netskope.Event.device_classification
      description: Netskope event device classification.
      type: String
    - contextPath: Netskope.Event.dom
      description: Netskope event Document Object Model (DOM).
      type: String
    - contextPath: Netskope.Event.dst_country
      description: Netskope event destination country.
      type: String
    - contextPath: Netskope.Event.dst_latitude
      description: Netskope event destination latitude.
      type: Number
    - contextPath: Netskope.Event.dst_location
      description: Netskope event destination location.
      type: String
    - contextPath: Netskope.Event.dst_longitude
      description: Netskope event destination longitude.
      type: Number
    - contextPath: Netskope.Event.dst_region
      description: Netskope event destination region.
      type: String
    - contextPath: Netskope.Event.dst_timezone
      description: Netskope event destination timezone.
      type: String
    - contextPath: Netskope.Event.dst_zipcode
      description: Netskope event destination zip code.
      type: String
    - contextPath: Netskope.Event.dstip
      description: Netskope event destination IP.
      type: String
    - contextPath: Netskope.Event.hostname
      description: Netskope event host name.
      type: String
    - contextPath: Netskope.Event.incident_id
      description: Netskope event incident ID.
      type: Number
    - contextPath: Netskope.Event.ja3
      description: A field indicating JA3 information.
      type: String
    - contextPath: Netskope.Event.ja3s
      description: A field indicating JA3S information.
      type: String
    - contextPath: Netskope.Event.managed_app
      description: Netskope event managed app.
      type: String
    - contextPath: Netskope.Event.managementID
      description: Netskope event management ID.
      type: String
    - contextPath: Netskope.Event.netskope_pop
      description: Netskope event Netskope POP.
      type: String
    - contextPath: Netskope.Event.notify_template
      description: Netskope event notify template.
      type: String
    - contextPath: Netskope.Event.nsdeviceuid
      description: Netskope event Netskope device UID.
      type: String
    - contextPath: Netskope.Event.organization_unit
      description: Netskope event organization unit.
      type: String
    - contextPath: Netskope.Event.os
      description: Netskope event operating system.
      type: String
    - contextPath: Netskope.Event.os_version
      description: Netskope event operating system version.
      type: String
    - contextPath: Netskope.Event.other_categories
      description: Netskope event other categories.
      type: String
    - contextPath: Netskope.Event.page
      description: Netskope event page.
      type: String
    - contextPath: Netskope.Event.page_site
      description: Netskope event page site.
      type: String
    - contextPath: Netskope.Event.policy
      description: Netskope event policy.
      type: String
    - contextPath: Netskope.Event.policy_id
      description: Netskope event policy ID.
      type: String
    - contextPath: Netskope.Event.port
      description: Netskope event port.
      type: Number
    - contextPath: Netskope.Event.protocol
      description: Netskope event protocol.
      type: String
    - contextPath: Netskope.Event.request_id
      description: Netskope event request ID.
      type: Number
    - contextPath: Netskope.Event.severity
      description: Netskope event severity.
      type: String
    - contextPath: Netskope.Event.site
      description: Netskope event site.
      type: String
    - contextPath: Netskope.Event.src_country
      description: Netskope event source country.
      type: String
    - contextPath: Netskope.Event.src_latitude
      description: Netskope event source latitude.
      type: Number
    - contextPath: Netskope.Event.src_location
      description: Netskope event source location.
      type: String
    - contextPath: Netskope.Event.src_longitude
      description: Netskope event source longitude.
      type: Number
    - contextPath: Netskope.Event.src_region
      description: Netskope event source region.
      type: String
    - contextPath: Netskope.Event.src_time
      description: Netskope event source time.
      type: Date
    - contextPath: Netskope.Event.src_timezone
      description: Netskope event source timezone.
      type: String
    - contextPath: Netskope.Event.src_zipcode
      description: Netskope event source zip code.
      type: String
    - contextPath: Netskope.Event.srcip
      description: Netskope event source IP.
      type: String
    - contextPath: Netskope.Event.telemetry_app
      description: Netskope event telemetry app.
      type: String
    - contextPath: Netskope.Event.timestamp
      description: Netskope event timestamp.
      type: Number
    - contextPath: Netskope.Event.traffic_type
      description: Netskope event traffic type.
      type: String
    - contextPath: Netskope.Event.transaction_id
      description: Netskope event transaction ID.
      type: Number
    - contextPath: Netskope.Event.type
      description: Netskope event type.
      type: String
    - contextPath: Netskope.Event.ur_normalized
      description: All lowercase user email.
      type: String
    - contextPath: Netskope.Event.url
      description: Netskope event URL.
      type: String
    - contextPath: Netskope.Event.user
      description: Netskope event user.
      type: String
    - contextPath: Netskope.Event.useragent
      description: Netskope event user agent.
      type: String
    - contextPath: Netskope.Event.userip
      description: Netskope event user IP.
      type: String
    - contextPath: Netskope.Event.userkey
      description: Netskope event user key.
      type: String
  - arguments:
    - description: The URL list ID to update (use netskope-url-list-list command to
        get URL list ID).
      name: url_list_id
      required: true
    - description: The updated URL list name.
      name: name
      required: true
    - description: The updated URL list items (For Exact - Enter URLs like  *.example.com,
        or IP addresses, separated by new line. For Regex - Enter URLs like ^client[0-9]\\.google\\.com
        , ^app\\.slack\\.com/.*/netskope, or ^google.com, separated by new line).
      isArray: true
      name: urls
      required: true
    - auto: PREDEFINED
      description: The updated URL list type.
      name: list_type
      predefined:
      - exact
      - regex
      required: true
    - auto: PREDEFINED
      defaultValue: "false"
      description: Whether to deploy URL list changes or not.
      name: deploy
      predefined:
      - "True"
      - "False"
    description: Update the URL list with the values provided. Note that this command
      overrides the list.
    name: netskope-url-list-update
    outputs:
    - contextPath: Netskope.URLList.id
      description: Netskope URL list ID.
      type: Number
    - contextPath: Netskope.URLList.name
      description: Netskope URL list name.
      type: String
    - contextPath: Netskope.URLList.data.urls
      description: Netskope URL list data URLs.
      type: String
    - contextPath: Netskope.URLList.data.type
      description: Netskope URL list data type.
      type: String
    - contextPath: Netskope.URLList.data.json_version
      description: Netskope URL list data JSON version.
      type: Number
    - contextPath: Netskope.URLList.modify_by
      description: Netskope URL list modify by.
      type: String
    - contextPath: Netskope.URLList.modify_time
      description: Netskope URL list modify time.
      type: Date
    - contextPath: Netskope.URLList.modify_type
      description: Netskope URL list modify type.
      type: String
    - contextPath: Netskope.URLList.pending
      description: Netskope URL list pending.
      type: Number
  - arguments:
    - description: The unique name for the URL list.
      name: name
      required: true
    - description: The URL list items (For Exact - Enter URLs like  *.example.com,
        or IP addresses, separated by new line. For Regex - Enter URLs like ^client[0-9]\\.google\\.com
        , ^app\\.slack\\.com/.*/netskope, or ^google.com, separated by new line).
      isArray: true
      name: urls
      required: true
    - auto: PREDEFINED
      description: The URL list type.
      name: list_type
      predefined:
      - exact
      - regex
      required: true
    - auto: PREDEFINED
      defaultValue: "false"
      description: Whether to deploy URL list changes or not.
      name: deploy
      predefined:
      - "True"
      - "False"
    description: Create a new URL list.
    name: netskope-url-list-create
    outputs:
    - contextPath: Netskope.URLList.id
      description: Netskope URL list ID.
      type: Number
    - contextPath: Netskope.URLList.name
      description: Netskope URL list name.
      type: String
    - contextPath: Netskope.URLList.data.urls
      description: Netskope URL list data URLs.
      type: String
    - contextPath: Netskope.URLList.data.type
      description: Netskope URL list data type.
      type: String
    - contextPath: Netskope.URLList.data.json_version
      description: Netskope URL list data JSON version.
      type: Number
    - contextPath: Netskope.URLList.modify_by
      description: Netskope URL list modify by.
      type: String
    - contextPath: Netskope.URLList.modify_time
      description: Netskope URL list modify time.
      type: Date
    - contextPath: Netskope.URLList.modify_type
      description: Netskope URL list modify type.
      type: String
    - contextPath: Netskope.URLList.pending
      description: Netskope URL list pending.
      type: Number
  - arguments:
    - description: The URL list ID to get.
      name: url_list_id
    - auto: PREDEFINED
      description: Get a list of only applied or pending URL lists.
      name: pending
      predefined:
      - applied
      - pending
    - description: 'Comma-separated data values to return in response call (for example:
        name, id, data, modify_by, modify_time, modify_type, pending). Defaults to
        all values.'
      isArray: true
      name: field
    - auto: PREDEFINED
      defaultValue: "false"
      description: Whether to retrieve all results or not.
      name: all_results
      predefined:
      - "True"
      - "False"
    - defaultValue: "50"
      description: The maximum number of records to retrieve.
      name: limit
    description: Get all URL lists or a specific URL list by specifying the list ID.
    name: netskope-url-lists-list
    outputs:
    - contextPath: Netskope.URLList.id
      description: Netskope URL list ID.
      type: Number
    - contextPath: Netskope.URLList.name
      description: Netskope URL list name.
      type: String
    - contextPath: Netskope.URLList.data.urls
      description: Netskope URL list data URLs.
      type: String
    - contextPath: Netskope.URLList.modify_by
      description: Netskope URL list modify by.
      type: String
    - contextPath: Netskope.URLList.modify_time
      description: Netskope URL list modify time.
      type: Date
    - contextPath: Netskope.URLList.modify_type
      description: Netskope URL list modify type.
      type: String
    - contextPath: Netskope.URLList.pending
      description: Netskope URL list pending status.
      type: String
  - arguments:
    - description: The URL list ID to delete (use netskope-url-list-list to get the
        URL list ID).
      name: url_list_id
      required: true
    - auto: PREDEFINED
      defaultValue: "false"
      description: Whether to deploy URL list changes or not.
      name: deploy
      predefined:
      - "True"
      - "False"
    description: Delete a URL list by the list ID.
    name: netskope-url-list-delete
    outputs:
    - contextPath: Netskope.URLList.id
      description: Netskope URL list ID.
      type: Number
    - contextPath: Netskope.URLList.name
      description: Netskope URL list name.
      type: String
  - arguments:
    - description: 'Filter the Netskope user by ''key eq value'' template. For example:
        userName eq "someUserName" OR externalId eq "User-Ext_id".'
      name: filter
    - description: 'Page number of paginated results. Minimum value: 1.'
      name: page
    - defaultValue: "50"
      description: The maximum number of records to retrieve.
      name: limit
    description: Get information about Netskope SCIM users. The command provides a
      list of users who have been imported into the Netskope tenant through SCIM integration.
      Users imported through other methods, such as manual CSV import or manual creation,
      will not be included in the returned results.
    name: netskope-client-list
    outputs:
    - contextPath: Netskope.Client.id
      description: Netskope client ID.
      type: Number
    - contextPath: Netskope.Client.name
      description: Netskope client name.
      type: String
    - contextPath: Netskope.Client.userName
      description: Netskope client username.
      type: String
    - contextPath: Netskope.Client.externalId
      description: Netskope client external ID.
      type: String
    - contextPath: Netskope.Client.active
      description: Netskope client activate.
      type: Boolean
    - contextPath: Netskope.Client.emails
      description: Netskope client emails.
      type: String
  dockerimage: demisto/python3:3.10.13.75921
  isfetch: true
  runonce: false
  script: |
    register_module_line('netskope_api_v2', 'start', __line__())
    ### pack version: 3.3.1
    import copy
    from http import HTTPStatus
    from typing import Any, NamedTuple
    from collections.abc import Callable




    MIN_PAGE_NUM = 1
    MAX_PAGE_SIZE = 50
    MIN_PAGE_SIZE = 1
    MAX_LIMIT = 50
    MIN_LIMIT = 1
    TIME_FORMAT = "%d-%m-%Y %H:%M"

    ALERT_HEADERS = [
        "alert_id",
        "alert_name",
        "alert_type",
        "severity",
        "action",
        "activity",
        "type",
        "acked",
        "_category_name",
        "_event_id",
        "domain",
        "dst_country",
        "policy",
        "port",
        "protocol",
        "md5",
        "timestamp",
    ]
    EVENT_HEADERS = {
        "application": [
            "event_id",
            "alert",
            "action",
            "activity",
            "category",
            "hostname",
            "policy",
            "severity",
            "type",
            "useragent",
            "timestamp",
        ],
        "page": [
            "event_id",
            "category",
            "domain",
            "page",
            "type",
            "user",
            "appcategory",
            "bypass_reason",
            "src_location",
            "srcip",
            "dst_location",
            "dstip",
            "timestamp",
        ],
        "audit": [
            "event_id",
            "audit_log_event",
            "severity_level",
            "count",
            "supporting_data",
            "timestamp",
        ],
        "infrastructure": [
            "event_id",
            "hostname",
            "timestamp",
            "serial",
            "metric_name",
            "metric_value",
        ],
        "network": [
            "event_id",
            "category",
            "domain",
            "page",
            "type",
            "user",
            "policy",
            "action",
            "protocol",
            "src_location",
            "srcip",
            "dst_location",
            "dstip",
            "timestamp",
        ],
    }
    URL_HEADER = [
        "id",
        "name",
        "urls",
        "type",
        "pending",
        "modify_by",
        "modify_time",
        "modify_type",
    ]

    URL_LIST_TYPE = {
        "Exact": "exact",
        "Regex": "regex",
    }


    class Pagination(NamedTuple):
        updated_page: int
        limit: int
        pagination_message: str


    class TimeArgs(NamedTuple):
        start_time_number: int | None
        end_time_number: int | None
        insertion_start_time_number: int | None
        insertion_end_time_number: int | None


    class Client(BaseClient):
        def __init__(
            self,
            server_url: str,
            api_token: str,
            verify: bool = False,
            proxy: bool = False,
        ):
            headers = {"Netskope-Api-Token": api_token}
            super().__init__(
                base_url=server_url, verify=verify, proxy=proxy, headers=headers
            )

        def list_alert(
            self,
            page: int,
            limit: int,
            alert_type: str | None = None,
            query: str | None = None,
            acked: bool | None = None,
            start_time: int | None = None,
            end_time: int | None = None,
            insertion_start_time: int | None = None,
            insertion_end_time: int | None = None,
        ) -> dict[str, Any]:
            """Get alerts generated by Netskope.

            Args:
                page (int): Page number of paginated results.
                limit (int): The maximum number of records to retrieve.
                alert_type (Optional[str], optional): Alert type. Defaults to None.
                query (Optional[str], optional): Free query to filter the alerts.
                    Defaults to None.
                acked (Optional[bool], optional): Whether to retrieve acknowledged alerts or not. Defaults to None.
                start_time (Optional[int], optional): Restrict alerts to those that have dates greater than the provided
                    date. Defaults to None.
                end_time (Optional[int], optional): Restrict alerts to those that have dates less than or equal to the
                    provided date. Defaults to None.
                insertion_start_time (Optional[int], optional): Restrict alerts to those that were inserted to the system
                    after the provided date. Defaults to None.
                insertion_end_time (Optional[int], optional): Restrict alerts to those that were inserted to the system
                    before the provided date. Defaults to None.

            Returns:
                Dict[str, Any]: API response from Netskope.
            """

            params = assign_params(
                limit=limit,
                offset=page,
                starttime=start_time,
                endtime=end_time,
                insertionstarttime=insertion_start_time,
                insertionendtime=insertion_end_time,
                type=alert_type,
                query=query,
                acked=acked,
            )

            return self._http_request("GET", "api/v2/events/data/alert", params=params)

        def list_event(
            self,
            page: int,
            limit: int,
            event_type: str,
            start_time: int | None = None,
            end_time: int | None = None,
            insertion_start_time: int | None = None,
            insertion_end_time: int | None = None,
            query: str | None = None,
        ) -> dict[str, Any]:
            """Get events from Netskope.

            Args:
                page (int): Page number of paginated results.
                limit (int): The maximum number of records to retrieve.
                event_type (str): Event type.
                start_time (Optional[int], optional): Restrict events to those that have dates greater than the provided
                    date. Defaults to None.
                end_time (Optional[int], optional): Restrict events to those that have dates less than or equal to the
                    provided date . Defaults to None.
                insertion_start_time (Optional[int], optional): Restrict events to those that were inserted to the system
                    after the provided date. Defaults to None.
                insertion_end_time (Optional[int], optional): Restrict events to those that were inserted to the system
                    before the provided date. Defaults to None.
                query (Optional[str], optional): Free query to filter the events. Defaults to None.

            Returns:
                Dict[str, Any]: API response from Netskope.
            """

            params = assign_params(
                limit=limit,
                offset=page,
                starttime=start_time,
                endtime=end_time,
                insertionstarttime=insertion_start_time,
                insertionendtime=insertion_end_time,
                query=query,
            )

            return self._http_request(
                "GET", f"api/v2/events/data/{event_type}", params=params
            )

        def update_url_list(
            self,
            url_list_id: str,
            name: str = None,
            urls: list[str] = None,
            list_type: str = None,
        ) -> dict[str, Any]:
            """Update (override) the given URL list.

            Args:
                url_list_id (str): URL list ID.
                name (str): URL list name.
                urls (List[str]): URL lists.
                list_type (str): URL list type.

            Returns:
                Dict[str, Any]: API response from Netskope.
            """

            data = {
                "data": {"type": list_type, "urls": urls},
                "name": name,
            }

            return self._http_request(
                "PUT", f"api/v2/policy/urllist/{url_list_id}", json_data=data
            )

        def create_url_list(
            self,
            name: str,
            urls: list[str],
            list_type: str,
        ) -> dict[str, Any]:
            """Create URL list.

            Args:
                name (str): URL list name.
                urls (List[str]): URL lists.
                list_type (str): URL list type.

            Returns:
                Dict[str, Any]: API response from Netskope.
            """

            data = {
                "data": {"type": list_type, "urls": urls},
                "name": name,
            }

            return self._http_request("POST", "api/v2/policy/urllist", json_data=data)

        def list_url_list(
            self,
            url_list_id: str | None,
            pending: int | None = None,
            field: list[str] = None,
        ) -> dict[str, Any]:
            """Get all URL Lists or a specific URL list by the list ID.

            Args:
                url_list_id (Optional[str]): _description_
                pending (Optional[int]): _description_
                field (List[str]): _description_

            Returns:
                Dict[str, Any]: API response from Netskope.
            """

            params = assign_params(
                pending=pending,
                field=field,
            )

            url_suffix = f"/{url_list_id}" if url_list_id else ""
            demisto.debug(f"{url_suffix=} {params=}")

            return self._http_request(
                "GET",
                f"api/v2/policy/urllist{url_suffix}",
                params=params,
            )

        def delete_url_list(self, url_list_id: str) -> dict[str, Any]:
            """Delete a URL list by the list ID.

            Args:
                url_list_id (str): URL list ID.

            Returns:
                Dict[str, Any]: API response from Netskope.
            """

            return self._http_request(
                "DELETE",
                f"api/v2/policy/urllist/{url_list_id}",
            )

        def list_client(
            self,
            page: int,
            limit: int,
            client_filter: str = None,
        ) -> dict[str, Any]:
            """Get information about Netskope SCIM users.

            Args:
                page (int): Page number of paginated results.
                limit (int): The maximum number of records to retrieve.
                client_filter (str, optional): Filter the Netskope user by 'key eq value' template. Defaults to None.

            Returns:
                Dict[str, Any]: API response from Netskope.
            """

            params = assign_params(count=limit, startIndex=page, filter=client_filter)

            return self._http_request(
                "GET",
                "api/v2/scim/Users",
                params=params,
            )

        def deploy_url_list(self) -> dict[str, Any]:
            """Deploy URL list changes.

            Returns:
                Dict[str, Any]: API response from Netskope.
            """

            return self._http_request(
                "POST",
                "api/v2/policy/urllist/deploy",
            )


    def list_alert_command(
        client: Client,
        args: dict[str, Any],
    ) -> CommandResults:
        """Get alerts generated by Netskope.

        Args:
            client (Client): Netskope API client.
            args (Dict[str, Any]): command arguments.

        Returns:
            CommandResults: outputs, readable outputs and raw response for XSOAR.
        """
        pagination_data = pagination(args)

        page = pagination_data.updated_page
        limit = pagination_data.limit
        pagination_message = pagination_data.pagination_message

        alert_type = args.get("alert_type")
        query = args.get("query")
        acked = optional_arg_to_boolean(args.get("retrieve_acknowledged"))

        time_args = convert_time_args_to_num(args)

        start_time = time_args.start_time_number
        end_time = time_args.end_time_number
        insertion_start_time = time_args.insertion_start_time_number
        insertion_end_time = time_args.insertion_end_time_number

        response = client.list_alert(
            page=page,
            limit=limit,
            start_time=start_time,
            end_time=end_time,
            insertion_start_time=insertion_start_time,
            insertion_end_time=insertion_end_time,
            alert_type=alert_type,
            query=query,
            acked=acked,
        )

        output = response["result"]

        for alert in output:
            alert["alert_id"] = alert["_id"]
            alert["timestamp"] = timestamp_to_datestring(alert["timestamp"] * 1000)

        readable_output = tableToMarkdown(
            name="Alert List",
            metadata=pagination_message,
            t=remove_empty_elements(output),
            headers=ALERT_HEADERS,
            headerTransform=string_to_table_header,
        )

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix="Netskope.Alert",
            outputs_key_field="id",
            outputs=output,
            raw_response=response,
        )


    def list_event_command(
        client: Client,
        args: dict[str, Any],
    ) -> CommandResults:
        """Get events extracted from SaaS traffic.

        Args:
            client (Client): Netskope API client.
            args (Dict[str, Any]): command arguments.

        Returns:
            CommandResults: outputs, readable outputs and raw response for XSOAR.
        """

        pagination_data = pagination(args)

        page = pagination_data.updated_page
        limit = pagination_data.limit
        pagination_message = pagination_data.pagination_message

        event_type = args["event_type"]
        query = args.get("query")

        time_args = convert_time_args_to_num(args)

        start_time = time_args.start_time_number
        end_time = time_args.end_time_number
        insertion_start_time = time_args.insertion_start_time_number
        insertion_end_time = time_args.insertion_end_time_number

        response = client.list_event(
            page=page,
            limit=limit,
            start_time=start_time,
            end_time=end_time,
            insertion_start_time=insertion_start_time,
            insertion_end_time=insertion_end_time,
            event_type=event_type,
            query=query,
        )

        output = response["result"]

        for event in output:
            event["event_id"] = event["_id"]
            event["timestamp"] = timestamp_to_datestring(event["timestamp"] * 1000)

        readable_output = tableToMarkdown(
            name="Event List",
            metadata=pagination_message,
            t=remove_empty_elements(output),
            headers=EVENT_HEADERS[event_type],
            headerTransform=string_to_table_header,
        )

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix="Netskope.Event",
            outputs_key_field="id",
            outputs=output,
            raw_response=response,
        )


    def update_url_list_command(
        client: Client,
        args: dict[str, Any],
    ) -> CommandResults:
        """Update (override) URL List.

        Args:
            client (Client): Netskope API client.
            args (Dict[str, Any]): command arguments.

        Returns:
            CommandResults: outputs, readable outputs and raw response for XSOAR.
        """
        url_list_id = args["url_list_id"]
        name = args.get("name")
        urls = argToList(args.get("urls"))
        list_type = URL_LIST_TYPE[args["list_type"]] if args.get("list_type") else None
        is_overwrite = optional_arg_to_boolean(args.get("is_overwrite"))

        if not all([name, urls, list_type]) or not is_overwrite:
            list_response = client.list_url_list(url_list_id=url_list_id)

            name = name or list_response.get("name")
            list_type = list_type or dict_safe_get(list_response, ["data", "type"])
            exist_urls = dict_safe_get(list_response, ["data", "urls"])

            if not is_overwrite:
                urls += exist_urls
            else:
                urls = urls or exist_urls

        response = client.update_url_list(
            url_list_id,
            name,
            urls,
            list_type,
        )

        deploy_url_list_if_required(args, client.deploy_url_list)
        output = get_updated_url_list(response)

        readable_output = tableToMarkdown(
            name="URL list was updated successfully",
            t=remove_empty_elements(output),
            headers=URL_HEADER,
            headerTransform=string_to_table_header,
        )

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix="Netskope.URLList",
            outputs_key_field="id",
            outputs=output,
            raw_response=response,
        )


    def create_url_list_command(
        client: Client,
        args: dict[str, Any],
    ) -> CommandResults:
        """Create a new URL list.

        Args:
            client (Client): Netskope API client.
            args (Dict[str, Any]): command arguments.

        Returns:
            CommandResults: outputs, readable outputs and raw response for XSOAR.
        """

        name = args["name"]
        urls = argToList(args["urls"])
        list_type = URL_LIST_TYPE[args["list_type"]]

        response = client.create_url_list(
            name,
            urls,
            list_type,
        )
        deploy_url_list_if_required(args, client.deploy_url_list)
        output = get_updated_url_list(response)

        readable_output = tableToMarkdown(
            name="URL list was created successfully",
            t=remove_empty_elements(output),
            headers=URL_HEADER,
            headerTransform=string_to_table_header,
        )

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix="Netskope.URLList",
            outputs_key_field="id",
            outputs=output,
            raw_response=response,
        )


    def lists_url_list_command(client: Client, args: dict[str, Any]) -> CommandResults:
        """Get all URL Lists or a specific URL list.

        Args:
            client (Client): Netskope API client.
            args (Dict[str, Any]): command arguments.

        Returns:
            CommandResults: outputs, readable outputs and raw response for XSOAR.
        """

        url_list_id = args.get("url_list_id")
        pending = args.get("pending")
        fields = argToList(args.get("field"))
        all_results = optional_arg_to_boolean(args.get("all_results"))
        pending = int(pending == "pending")

        updated_fields = []
        updated_fields = [
            "data" if field in ("urls", "type") else field for field in fields
        ]

        response = client.list_url_list(
            url_list_id=url_list_id, pending=pending, field=updated_fields
        )
        output = get_updated_url_list(response)

        if not all_results:
            limit = arg_to_number(args["limit"])
            output = output[:limit]

        readable_output = tableToMarkdown(
            name="URL Lists",
            t=remove_empty_elements(output),
            headers=fields or URL_HEADER,
            headerTransform=string_to_table_header,
        )

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix="Netskope.URLList",
            outputs_key_field="id",
            outputs=response,
            raw_response=response,
        )


    def delete_url_list_command(
        client: Client,
        args: dict[str, Any],
    ) -> CommandResults:
        """Delete a URL list by the list ID.

        Args:
            client (Client): Netskope API client.
            args (Dict[str, Any]): command arguments.

        Returns:
            CommandResults: outputs, readable outputs and raw response for XSOAR.
        """

        url_list_id = args["url_list_id"]

        response = client.delete_url_list(url_list_id)
        deploy_url_list_if_required(args, client.deploy_url_list)

        return CommandResults(
            readable_output=f"The URL list {url_list_id} was deleted successfully",
            outputs_prefix="Netskope.URLList",
            outputs_key_field="id",
            outputs=response,
            raw_response=response,
        )


    def list_client_command(
        client: Client,
        args: dict[str, Any],
    ) -> CommandResults:
        """Get information about Netskope SCIM users.

        Args:
            client (Client): Netskope API client.
            args (Dict[str, Any]): command arguments.

        Returns:
            CommandResults: outputs, readable outputs and raw response for XSOAR.
        """
        pagination_data = pagination(args)

        page = pagination_data.updated_page
        limit = pagination_data.limit
        pagination_message = pagination_data.pagination_message

        client_filter = args.get("filter")
        updated_client_filter = (
            convert_client_filter(client_filter) if client_filter else None
        )

        response = client.list_client(page, limit, updated_client_filter)
        output = response.get("Resources", [])
        output = get_updated_list_client(output)

        readable_output = tableToMarkdown(
            name="Client List",
            t=remove_empty_elements(output),
            metadata=pagination_message,
            headers=[
                "client_id",
                "external_id",
                "user_name",
                "given_name",
                "family_name",
                "emails",
                "active",
            ],
            headerTransform=string_to_table_header,
        )

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix="Netskope.Client",
            outputs_key_field="id",
            outputs=output,
            raw_response=response,
        )


    def test_module(client: Client) -> str:
        try:
            client.list_client(1, 1)
            return "ok"
        except DemistoException as exc:
            if exc.res is not None and exc.res.status_code in [
                HTTPStatus.UNAUTHORIZED,
                HTTPStatus.NOT_FOUND,
                HTTPStatus.FORBIDDEN,
            ]:
                return "Authorization Error: Unknown API key or Netskope URL"

            return exc.message


    def fetch_incidents(client: Client, params: dict[str, Any]):
        """Fetch Netskope alerts and events (if requested) as incidents in XSOAR.

        Args:
            client (Client): Netskope API client.
            params (Dict[str, Any]): Integration parameters.
        """

        incidents: list[dict] = []
        last_run: dict[str, Any] = {}

        event_types = argToList(params.get("event_types"))
        alert_query = params.get("alert_query")
        alert_max_fetch = arg_to_number(params["max_fetch"]) or MAX_LIMIT

        if (
            event_types
            and (event_max_fetch := arg_to_number(params["max_events_fetch"])) is not None
        ):
            max_fetch_per_event_type = event_max_fetch // (len(event_types))
            demisto.debug(f"{event_max_fetch=} so {max_fetch_per_event_type=}")

        if params.get("fetch_events") and event_types:
            incidents, last_run = fetch_event_as_incidents(
                list_event_func=client.list_event,
                params=params,
                max_fetch_per_event_type=max_fetch_per_event_type,
            )

        last_run_id, last_run_timestamp = get_last_run(params, "alert")
        end_time_number = date_to_seconds_timestamp(datetime.now())

        response = client.list_alert(
            query=alert_query,
            limit=alert_max_fetch,
            page=0,
            start_time=last_run_timestamp,
            end_time=end_time_number,
        )

        alerts = response["result"]
        relevant_alerts = []
        for alert in alerts:
            # Validate the alerts IDs is different from the last run alert ID to avoid duplicates
            if last_run_id != alert["_id"]:
                alert["incident_type"] = alert["alert_type"]
                incidents.append(parse_incident(alert, "alert"))
                relevant_alerts.append(alert)

        last_run = update_last_run(
            relevant_events=relevant_alerts,
            incident_type="alert",
            last_run=last_run,
            last_run_id=last_run_id,
            last_run_time_number=last_run_timestamp,
        )

        return last_run, incidents


    # HELPERS FUNCTIONS #


    def parse_incident(incident: dict, incident_type: str) -> dict:
        """
        Parse alert/event to XSOAR Incident.

        Args:
            incident (dict): alert/event item.
            incident_type (str): Incident type.

        Returns:
            dict: XSOAR Incident.
        """
        return {
            "name": f'{incident_type} ID: {incident["_id"]}',
            "occurred": convert_datetime_int_to_iso(incident["timestamp"]),
            "rawJSON": json.dumps(incident),
        }


    def convert_datetime_int_to_iso(creation_timestamp: int) -> datetime:
        """Convert datetime to iso.

        Args:
            creation_timestamp (int): creation timestamp argument.

        Returns:
            datetime: Updated argument.
        """
        date_string = convert_number_to_str_date(creation_timestamp)
        alert_date = datetime.strptime(date_string, TIME_FORMAT)
        return FormatIso8601(alert_date) + "Z"


    def fetch_event_as_incidents(
        list_event_func: Callable,
        params: dict[str, Any],
        max_fetch_per_event_type: int,
    ) -> tuple[list, dict]:
        """Fetch events from Netskope as incidents.

        Args:
            list_event_func (Callable): Netskope API client.
            params (Dict[str, Any]): Integration parameters.
            max_fetch_per_event_type (int): Maximum number per event type.

        Returns:Callable
            Tuple[list, dict]: Events as incidents and updated last_run argument.
        """
        incidents = []
        last_run: dict[str, Any] = {}

        event_types = argToList(params.get("event_types"))
        event_query = params.get("event_query")
        for event_type in event_types:
            relevant_events = []
            last_run_id, last_run_datetime_str = get_last_run(params, event_type)
            end_time_number = date_to_seconds_timestamp(datetime.now())

            response = list_event_func(
                event_type=event_type,
                query=event_query,
                limit=max_fetch_per_event_type,
                page=0,
                start_time=last_run_datetime_str,
                end_time=end_time_number,
            )
            events = response["result"]

            for event in events:
                if last_run_id != event["_id"]:
                    event["incident_type"] = event_type
                    incidents.append(parse_incident(event, f"{event_type}-event"))
                    relevant_events.append(event)

            last_run = update_last_run(
                relevant_events=relevant_events,
                incident_type=event_type,
                last_run=last_run,
                last_run_id=last_run_id,
                last_run_time_number=last_run_datetime_str,
            )

        return incidents, last_run


    def update_last_run(
        relevant_events: list,
        incident_type: str,
        last_run: dict,
        last_run_id: Any | None,
        last_run_time_number: int,
    ) -> dict[str, Any]:
        """Update the last run argument by alert type for next run.

        Args:
            relevant_events (list): The new incidents.
            incident_type (str): Incident type.
            last_run (dict): Last run argument.
            last_run_id (int): Last run ID.
            last_run_time_number (int): The last run time number.

        Returns:
            Dict[str, Any]: Updated last run argument.
        """
        if relevant_events:
            last_run_alert = max(relevant_events, key=lambda k: k["timestamp"])

            last_run[incident_type] = {
                "id": last_run_alert["_id"],
                "time": last_run_alert["timestamp"] + 1,
                "date": convert_number_to_str_date(last_run_time_number),
            }

        else:
            last_run[incident_type] = {
                "id": last_run_id,
                "time": last_run_time_number,
                "date": convert_number_to_str_date(last_run_time_number),
            }
        return last_run


    def get_last_run(args: dict[str, Any], incident_type: str) -> tuple[Any | None, int]:
        """Get last run arguments.

        Args:
            args (Dict[str, Any]): XSOAR arguments.
            incident_type (str): Incident type.

        Returns:
            Tuple: Updated last run arguments.
        """
        last_run = demisto.getLastRun()
        ticket_last_run = last_run.get(incident_type)
        last_run_id = None

        if last_run and ticket_last_run:
            last_run_time = ticket_last_run.get("time")
            last_run_id = ticket_last_run.get("id")
        else:
            last_run_time = args.get("first_fetch", "3 Days")

        first_fetch = arg_to_datetime(
            arg=last_run_time, arg_name="First fetch time", required=True
        )
        if not first_fetch:
            raise ValueError("First fetch time not specified")

        last_run_timestamp = date_to_seconds_timestamp(first_fetch)

        return last_run_id, last_run_timestamp


    def deploy_url_list_if_required(args: dict[str, Any], deploy_url_list_func: Callable):
        """Deploys URL list changes if required.

        Args:
            client (Client): Netskope API client.
            args (Dict[str, Any]): command arguments.
        """

        if optional_arg_to_boolean(args.get("deploy")):
            deploy_url_list_func()


    def convert_client_filter(client_filter: str) -> str:
        """Convert client filter to the appropriate format.

        Args:
            client_filter (str): client filter.

        Returns:
            str: Updated filter.
        """
        filter_parts = [part.strip() for part in client_filter.split("eq")]

        if len(filter_parts) != 2:
            raise DemistoException("Filter must contain 'key' eq 'value'")

        attribute_name, attribute_value = filter_parts

        attribute_value = attribute_value.strip().strip('"')

        modified_filter = f'{attribute_name} eq "{attribute_value}"'

        return modified_filter


    def get_updated_list_client(response: list | dict) -> list:
        """Updates URL list response.

        Args:
            response (Union[List, Dict]): The API response.

        Returns:
            List: Updated URL list.
        """
        outputs = []
        for list_client in response:
            output = copy.deepcopy(list_client)
            output["client_id"] = output.pop("id")
            output |= output.pop("name", {})
            output["emails"] = [email.get("value") for email in output.get("emails", [])]
            output = snakify(output)
            outputs.append(output)
        return outputs


    def get_updated_url_list(response: list | dict) -> list:
        """Updates URL list response.

        Args:
            response (Union[List, Dict]): The API response.

        Returns:
            List: Updated URL list.
        """
        response = [response] if isinstance(response, dict) else response
        outputs = []
        number_to_pending_status = {
            0: "applied",
            1: "pending",
        }
        for url_list in response:
            output = copy.deepcopy(url_list)
            output |= output.pop("data", {})
            output["pending"] = number_to_pending_status.get(output.get("pending"))
            outputs.append(output)
        return outputs


    def parse_start_end_times(
        start_str: str, end_str: str | None
    ) -> tuple[int | None, int | None]:
        """Convert string date to timestamp.

        Args:
            start_str (str): String start date.
            end_str (Optional[str]): String end date.

        Returns:
            Tuple: Timestamp start & end dates.
        """
        start_number = arg_to_seconds_timestamp(start_str) if start_str else None
        end_number = (
            arg_to_seconds_timestamp(end_str)
            if end_str
            else date_to_seconds_timestamp(datetime.now())
        )
        return start_number, end_number


    def convert_time_args_to_num(args: dict[str, Any]) -> TimeArgs:
        """Convert relevant time arguments to numbers timestamp.
        Args:
            args (Dict[str, Any]): command arguments.
        Raises:
            ValueError: When specified all time arguments or not specified none of them.
        Returns:
            Tuple: The updated time arguments.
        """
        start_time_str = args.get("start_time")
        end_time_str = args.get("end_time")
        insertion_start_time_str = args.get("insertion_start_time")
        insertion_end_time_str = args.get("insertion_end_time")

        start_time_number = None
        end_time_number = None
        insertion_start_time_number = None
        insertion_end_time_number = None

        if start_time_str:
            start_time_number, end_time_number = parse_start_end_times(
                start_time_str, end_time_str
            )
        elif insertion_start_time_str:
            insertion_start_time_number, insertion_end_time_number = parse_start_end_times(
                insertion_start_time_str, insertion_end_time_str
            )
        else:
            raise ValueError(
                "Provide either the `start_time` argument or `insertion_start_time`."
            )

        return TimeArgs(
            start_time_number,
            end_time_number,
            insertion_start_time_number,
            insertion_end_time_number,
        )


    def convert_number_to_str_date(number: int) -> str:
        """Convert number to date string.

        Args:
            number (int): The date number to convert.

        Returns:
            str: The string date.
        """

        return datetime.fromtimestamp(float(number)).strftime(TIME_FORMAT)


    def arg_to_seconds_timestamp(arg: str | datetime) -> int | None:
        """
        Converts an XSOAR date string argument to a timestamp in seconds.

        Args:
            arg (Optional[str]): The argument to convert.

        Returns:
            Optional[int]: A timestamp if arg can be converted,
            or None if arg is None.
        """
        date_arg = arg_to_datetime(arg)

        if date_arg is None:
            return None

        return date_to_seconds_timestamp(date_arg)


    def date_to_seconds_timestamp(date_str_or_dt: str | datetime) -> int:
        """
        Converts date string or datetime object to a timestamp in seconds.

        Args:
            date_str_or_dt (Union[str, datetime]): The datestring or datetime.

        Returns:
            int: The timestamp in seconds.
        """

        return date_to_timestamp(date_str_or_dt) // 1000


    def validate_pagination_arguments(
        page: int | None = None,
        limit: int | None = None,
    ):
        """Validate pagination arguments according to their default.

        Args:
            page (int, optional): Page number of paginated results.
            page_size (int, optional): Number of items per page.
            limit (int, optional): The maximum number of records to retrieve.

        Raises:
            ValueError: Incase page is lower than 1 or Incase limit is lower than 1.
        """
        if page is not None and page < MIN_PAGE_NUM:
            raise ValueError(f"page argument must be greater than {MIN_PAGE_NUM}.")
        if limit is not None and limit < MIN_LIMIT:
            raise ValueError(f"limit argument must be greater than {MIN_LIMIT}.")


    def pagination(args: dict[str, Any]) -> Pagination:
        """Return the correct limit and offset for the API
            based on the user arguments page and limit.

        Args:
            args (Dict[str, Any]): Command arguments from XSOAR.

        Returns:
            Tuple: page, limit, pagination_message.
        """
        page = arg_to_number(args.get("page", 1))
        limit = arg_to_number(args.get("page")) or 50

        validate_pagination_arguments(page, limit)

        pagination_message = f"Showing page {page}. \n Current page size: {limit}."
        updated_page = page - 1 if isinstance(page, int) else 1
        return Pagination(updated_page, limit, pagination_message)


    def optional_arg_to_boolean(arg: str | bool | None) -> bool | None:
        """Retrieve arg boolean value if it's not none.
        Args:
            arg (Union[str, bool, None]): Boolean argument.
        Returns:
            Optional[bool]: The argument boolean value.
        """
        return argToBoolean(arg) if arg is not None else None


    def main() -> None:
        params: dict[str, Any] = demisto.params()
        args: dict[str, Any] = demisto.args()

        url = params["url"]
        api_token = params["credentials"]["password"]
        proxy = params.get("proxy", False)
        verify_certificate: bool = not params.get("insecure", False)

        command = demisto.command()
        demisto.debug(f"Command being called is {command}")

        try:
            client: Client = Client(
                url,
                api_token,
                verify_certificate,
                proxy,
            )

            commands = {
                "netskope-alert-list": list_alert_command,
                "netskope-event-list": list_event_command,
                "netskope-url-list-update": update_url_list_command,
                "netskope-url-list-create": create_url_list_command,
                "netskope-url-lists-list": lists_url_list_command,
                "netskope-url-list-delete": delete_url_list_command,
                "netskope-client-list": list_client_command,
            }

            if command == "test-module":
                return_results(test_module(client))
            elif command == "fetch-incidents":
                last_run, incidents = fetch_incidents(client, params)
                demisto.setLastRun(last_run)
                demisto.incidents(incidents)
            elif command in commands:
                return_results(commands[command](client, args))
            else:
                raise NotImplementedError(f"{command} command is not implemented.")

        except Exception as e:
            return_error(str(e))


    if __name__ in ["__main__", "builtin", "builtins"]:
        main()

    register_module_line('netskope_api_v2', 'end', __line__())
  subtype: python3
  type: python
system: true
